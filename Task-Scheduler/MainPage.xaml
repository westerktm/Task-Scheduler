<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Task_Scheduler.MainPage">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackLayout Grid.Row="0" 
                     Orientation="Vertical"
                     Padding="20,0,20,0">
            <Label Text="Задачи" 
                   FontSize="28"
                   HorizontalOptions="Center" 
                   Margin="0,10,0,70" />

            <Label x:Name="NoTasksLabel"
                   Text="Похоже, у вас нет задач :(" 
                   FontSize="24" 
                   HorizontalOptions="Center" 
                   HorizontalTextAlignment="Center"
                   IsVisible="True"
                   Margin="10,200,0,10"/>

            <Button x:Name="CreateTaskButton"
                    Text="+ Создать задачу" 
                    TextColor="#333333"
                    BackgroundColor="#F5F5F5"
                    CornerRadius="10"
                    Padding="20,10"
                    MinimumWidthRequest="150"
                    HorizontalOptions="Center"
                    Pressed="OnCreateTaskButtonPressed"
                    Released="OnCreateTaskButtonReleased"
                    Clicked="OnCreateTaskButtonClicked" />

            <ImageButton x:Name="PlusImageButton"
                        Source="plus.png"
                        WidthRequest="50"
                        HeightRequest="50"
                        HorizontalOptions="Center"
                        VerticalOptions="Center"
                        IsVisible="False"
                        Clicked="OnPlusImageButtonClicked" 
                        ToolTipProperties.Text="Создать задачу"
                        Margin="0,0,0,0"/>
        </StackLayout>

        <Frame Grid.Row="1"
               BackgroundColor="White"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               WidthRequest="900"
               HorizontalOptions="Start"
               VerticalOptions="FillAndExpand"
               Margin="320,0,0,0">
            <ScrollView Orientation="Vertical">
                <StackLayout x:Name="TasksContainer" 
                             Spacing="15"
                             VerticalOptions="Start" />
            </ScrollView>
        </Frame>

        <!-- "Task Scheduler" в левом верхнем углу -->
        <Label Text="Task Scheduler" 
               FontSize="24" 
               HorizontalOptions="Start"
               VerticalOptions="Start"
               Margin="130,10,0,0" />

        <!-- Аватар в правом верхнем углу -->
        <ImageButton x:Name="AvatarImageButton"
                    Source="avatar.png"
                    WidthRequest="40"
                    HeightRequest="40"
                    CornerRadius="5"
                    HorizontalOptions="End"
                    VerticalOptions="Start"
                    Margin="0,0,10,0"
                    ToolTipProperties.Text="Профиль"
                    Clicked="OnAvatarClicked" />
        
        <!-- Кнопка настроек -->
        <ImageButton x:Name="SettingsImageButton"
                     Source="setting.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,70,0"
                     ToolTipProperties.Text="Настройки"
                     Clicked="OnSettingsClicked" />

        <ImageButton x:Name="NotificationsImageButton"
                     Source="notifications.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,130,0"
                     ToolTipProperties.Text="Уведомления"
                     Clicked="OnAvatarClicked" />
        
        <ImageButton x:Name="FavoritesImageButton"
                     Source="favorites.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,190,0"
                     ToolTipProperties.Text="Избранное"
                     Clicked="OnFavoritesClicked" />

        <ImageButton x:Name="LogoImageButton"
                     Source="logo.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="80,0,0,0"                  
                     Clicked="OnAvatarClicked" />

        <ImageButton x:Name="MenuImageButton"
                     Source="menu.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,0,0,0"
                     ToolTipProperties.Text="Меню"
                     Clicked="OnMenuClicked" />
        
        <ImageButton x:Name="RefreshImageButton"
                     Source="refresh.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,60,0,0"
                     ToolTipProperties.Text="Обновить"
                     Clicked="OnRefreshClicked" />

        <ImageButton x:Name="SortImageButton"
                     Source="sort.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,120,0,0"
                     ToolTipProperties.Text="Сортировка"
                     Clicked="OnSortClicked" />

        <!-- Выдвигающееся меню -->
        <Grid x:Name="MenuOverlay"
              IsVisible="False"
              Opacity="0">
            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnMenuOverlayTapped" />
            </Grid.GestureRecognizers>
        </Grid>

        <Frame x:Name="SideMenu"
               BackgroundColor="White"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               WidthRequest="250"
               HorizontalOptions="Start"
               VerticalOptions="Start"
               TranslationX="-250"
               IsVisible="True">
            <StackLayout Spacing="15" VerticalOptions="Start">
                <Label Text="Меню"
                       FontSize="20"
                       FontAttributes="Bold"
                       Margin="0,20,0,10" />

                <StackLayout x:Name="MenuMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnMenuMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="menu.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="Меню"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="RefreshMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnRefreshMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="refresh.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="Обновить"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="SortMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnSortMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="sort.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="Сегодня"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>
            </StackLayout>
        </Frame>

        <!-- Панель настроек с переключателем темы -->
        <Frame x:Name="SettingsPanel"
               BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}"
               HasShadow="True"
               CornerRadius="10"
               Padding="15"
               WidthRequest="220"
               HorizontalOptions="End"
               VerticalOptions="Start"
               Margin="0,60,10,0"
               IsVisible="False">
            <StackLayout Spacing="10">
                <Label Text="Настройки"
                       FontSize="18"
                       FontAttributes="Bold" />

                <StackLayout Orientation="Horizontal"
                             Spacing="10"
                             VerticalOptions="Center">
                    <Label Text="Тёмная тема"
                           VerticalOptions="Center" />
                    <Switch x:Name="ThemeSwitch"
                            HorizontalOptions="EndAndExpand"
                            Toggled="OnThemeSwitchToggled" />
                </StackLayout>
            </StackLayout>
        </Frame>
    </Grid>
   
</ContentPage>
