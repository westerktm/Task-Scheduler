<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Task_Scheduler.MainPage">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∫–Ω–æ–ø–∫–∞–º–∏ -->
        <Grid Grid.Row="0" 
              RowDefinitions="Auto"
              ColumnDefinitions="Auto,*,Auto,Auto,Auto,Auto,Auto,Auto"
              Padding="20,10"
              HorizontalOptions="Fill"
              VerticalOptions="Start">
            
            <!-- –õ–µ–≤–∞—è –≥—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ -->
            <StackLayout Grid.Column="0" 
                         Orientation="Horizontal" 
                         Spacing="10"
                         VerticalOptions="Center">
                <ImageButton x:Name="MenuImageButton"
                             Source="{AppThemeBinding Light=menu.png, Dark=menublacktheme.png}"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             ToolTipProperties.Text="–ú–µ–Ω—é"
                             Clicked="OnMenuClicked" />
                
                <ImageButton x:Name="LogoImageButton"
                             Source="logo.png"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             Clicked="OnAvatarClicked" />
                
                <Label Text="Task Scheduler" 
                       FontSize="24" 
                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                       VerticalOptions="Center" />
            </StackLayout>

            <!-- –ü—Ä–∞–≤–∞—è –≥—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ -->
            <StackLayout Grid.Column="7" 
                         Orientation="Horizontal" 
                         Spacing="10"
                         HorizontalOptions="End"
                         VerticalOptions="Center">
              
                              
                
                <ImageButton x:Name="FavoritesImageButton"
                             Source="{AppThemeBinding Light=favorites.png, Dark=favblacktheme.png}"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             ToolTipProperties.Text="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"
                             Clicked="OnFavoritesClicked" />
                
                <ImageButton x:Name="NotificationsImageButton"
                             Source="{AppThemeBinding Light=notifications.png, Dark=notiblacktheme.png}"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             ToolTipProperties.Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                             Clicked="OnNotificationsClicked" />
                
                <ImageButton x:Name="SettingsImageButton"
                             Source="{AppThemeBinding Light=setting.png, Dark=settingsblacktheme.png}"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             ToolTipProperties.Text="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                             Clicked="OnSettingsClicked" />
                
                <ImageButton x:Name="AvatarImageButton"
                             Source="{AppThemeBinding Light=avatar.png, Dark=avatarblacktheme.png}"
                             WidthRequest="40"
                             HeightRequest="40"
                             CornerRadius="5"
                             ToolTipProperties.Text="–ü—Ä–æ—Ñ–∏–ª—å"
                             Clicked="OnAvatarClicked" />
            </StackLayout>
        </Grid>

        <!-- –û–±–ª–∞—Å—Ç—å —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –∫–Ω–æ–ø–∫–∞–º–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
        <StackLayout Grid.Row="1" 
                     Orientation="Vertical"
                     Padding="20,10">
            <Label x:Name="TasksLabel"
                   Text="–ó–∞–¥–∞—á–∏" 
                   FontSize="28"
                   TextColor="{AppThemeBinding Light=Black, Dark=White}"
                   HorizontalOptions="Center" 
                   Margin="0,10,0,130">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTasksLabelClicked" />
                </Label.GestureRecognizers>
            </Label>

            <Label x:Name="NoTasksLabel"
                   Text="–ü–æ—Ö–æ–∂–µ, —É –≤–∞—Å –Ω–µ—Ç –∑–∞–¥–∞—á :(" 
                   FontSize="24" 
                   TextColor="{AppThemeBinding Light=Black, Dark=White}"
                   HorizontalOptions="Center" 
                   HorizontalTextAlignment="Center"
                   IsVisible="True"
                   Margin="10,10,0,10"/>

            <Button x:Name="CreateTaskButton"
                    Text="+ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É" 
                    TextColor="#333333"
                    BackgroundColor="#F5F5F5"
                    CornerRadius="10"
                    Padding="20,10"
                    MinimumWidthRequest="150"
                    HorizontalOptions="Center"
                    Pressed="OnCreateTaskButtonPressed"
                    Released="OnCreateTaskButtonReleased"
                    Clicked="OnCreateTaskButtonClicked" />

            <ImageButton x:Name="PlusImageButton"
                        Source="{AppThemeBinding Light=plus.png, Dark=plusblacktheme.png}"
                        WidthRequest="50"
                        HeightRequest="50"
                        HorizontalOptions="Center"
                        VerticalOptions="Center"
                        IsVisible="False"
                        Clicked="OnPlusImageButtonClicked" 
                        ToolTipProperties.Text="–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É"
                        Margin="0,0,0,0"/>

        </StackLayout>

        <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∑–∞–¥–∞—á -->
        <Frame Grid.Row="2"
               BackgroundColor="{AppThemeBinding Light=White, Dark={StaticResource OffBlack}}"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               HorizontalOptions="Fill"
               VerticalOptions="Fill"
               Margin="20,0">
            <ScrollView Orientation="Vertical">
                <StackLayout x:Name="TasksContainer" 
                             Spacing="15"
                             VerticalOptions="Start" />
            </ScrollView>
        </Frame>


        <!-- –í—ã–¥–≤–∏–≥–∞—é—â–µ–µ—Å—è –º–µ–Ω—é -->
        <Grid x:Name="MenuOverlay"
              Grid.RowSpan="3"
              BackgroundColor="Black"
              Opacity="0"
              IsVisible="False">
            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnMenuOverlayTapped" />
            </Grid.GestureRecognizers>
        </Grid>

        <Frame x:Name="SideMenu"
               Grid.RowSpan="3"
               BackgroundColor="{AppThemeBinding Light=White, Dark={StaticResource OffBlack}}"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               WidthRequest="250"
               MaximumWidthRequest="300"
               MinimumWidthRequest="200"
               HorizontalOptions="Start"
               VerticalOptions="Fill"
               TranslationX="-250"
               IsVisible="True">
            <StackLayout Spacing="15" VerticalOptions="Start">
                <Label Text="–ú–µ–Ω—é"
                       FontSize="20"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                       Margin="0,20,0,10" />

                <StackLayout x:Name="MenuMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnMenuMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="{AppThemeBinding Light=menu.png, Dark=menublacktheme.png}"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–ú–µ–Ω—é"
                           FontSize="16"
                           TextColor="{AppThemeBinding Light=Black, Dark=White}"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="RefreshMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnRefreshMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="{AppThemeBinding Light=refresh.png, Dark=refblacktheme.png}"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–û–±–Ω–æ–≤–∏—Ç—å"
                           FontSize="16"
                           TextColor="{AppThemeBinding Light=Black, Dark=White}"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="SortMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnSortMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="{AppThemeBinding Light=sort.png, Dark=sortblacktheme.png}"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞"
                           FontSize="16"
                           TextColor="{AppThemeBinding Light=Black, Dark=White}"
                           VerticalOptions="Center" />
                </StackLayout>

                <Label Text="–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                       FontSize="16"
                       FontAttributes="Bold"
                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                       Margin="0,15,0,5" />
                <StackLayout x:Name="DisplayListMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,0,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayListTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìã –°–ø–∏—Å–æ–∫" FontSize="18" VerticalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                </StackLayout>
                <StackLayout x:Name="DisplayKanbanMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,0,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayKanbanTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìä Kanban" FontSize="18" VerticalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                </StackLayout>
                <StackLayout x:Name="DisplayCalendarMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,0,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayCalendarTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å" FontSize="18" VerticalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                </StackLayout>
                <StackLayout x:Name="DisplayGanttMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,0,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayGanttTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìà –ì–∞–Ω—Ç–∞" FontSize="18" VerticalOptions="Center" TextColor="{AppThemeBinding Light=Black, Dark=White}" />
                </StackLayout>
            </StackLayout>
        </Frame>

        <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞) -->
        <Grid Grid.RowSpan="3"
              ZIndex="999"
              IsVisible="False"
              Opacity="0"
              x:Name="SettingsOverlay">
            <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–Ω—ã–π —Ñ–æ–Ω (–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–π –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è) -->
            <BoxView BackgroundColor="Black" 
                     Opacity="0.3"
                     InputTransparent="False">
                <BoxView.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnSettingsOverlayTapped" />
                </BoxView.GestureRecognizers>
            </BoxView>
            
            <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
            <Frame x:Name="SettingsPanel"
                   BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}"
                   HasShadow="True"
                   CornerRadius="10"
                   Padding="15"
                   WidthRequest="280"
                   MaximumWidthRequest="350"
                   IsVisible="False"
                   Opacity="0"
                   Scale="1"
                   TranslationX="0"
                   InputTransparent="False"
                   HorizontalOptions="End"
                   VerticalOptions="Start"
                   Margin="10,60,10,0">
            <ScrollView MaximumHeightRequest="420">
                <StackLayout Spacing="16">
                    <Label Text="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                           FontSize="18"
                           FontAttributes="Bold"
                           Margin="0,0,0,4" />

                    <!-- 1. –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ -->
                    <Label Text="–í–Ω–µ—à–Ω–∏–π –≤–∏–¥"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <Picker x:Name="SettingsDisplayModePicker"
                            Title="–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                            SelectedIndexChanged="OnSettingsDisplayModeChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–°–ø–∏—Å–æ–∫</x:String>
                                <x:String>Kanban</x:String>
                                <x:String>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</x:String>
                                <x:String>–ì–∞–Ω—Ç–∞</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <!-- 2. –¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è -->
                    <Label Text="–¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <Picker x:Name="SettingsThemePicker"
                            Title="–¢–µ–º–∞"
                            SelectedIndexChanged="OnSettingsThemeChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–°–∏—Å—Ç–µ–º–Ω–∞—è</x:String>
                                <x:String>–°–≤–µ—Ç–ª–∞—è</x:String>
                                <x:String>–¢—ë–º–Ω–∞—è</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <Picker x:Name="SettingsFontPicker"
                            Title="–®—Ä–∏—Ñ—Ç"
                            SelectedIndexChanged="OnSettingsFontChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–°–∏—Å—Ç–µ–º–Ω—ã–π</x:String>
                                <x:String>OpenSans Regular</x:String>
                                <x:String>OpenSans Semibold</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <Picker x:Name="SettingsAccentPicker"
                            Title="–ê–∫—Ü–µ–Ω—Ç"
                            SelectedIndexChanged="OnSettingsAccentChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</x:String>
                                <x:String>–°–∏–Ω–∏–π</x:String>
                                <x:String>–ó–µ–ª—ë–Ω—ã–π</x:String>
                                <x:String>–û—Ä–∞–Ω–∂–µ–≤—ã–π</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <!-- 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                    <Label Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <StackLayout Orientation="Horizontal" Spacing="10" VerticalOptions="Center">
                        <Label Text="–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                               VerticalOptions="Center"
                               FontSize="13" />
                        <Switch x:Name="SettingsNotificationsSwitch"
                                HorizontalOptions="EndAndExpand"
                                Toggled="OnSettingsNotificationsToggled" />
                    </StackLayout>
                    <Label Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –∏—Ö –∑–¥–µ—Å—å."
                           FontSize="11"
                           TextColor="{AppThemeBinding Light=#666666, Dark=#B0B0B0}"
                           Margin="0,0,0,5" />
                    <Label Text="–¢–∏—Ö–∏–µ —á–∞—Å—ã (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è):"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light=#666666, Dark=#B0B0B0}" />
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                        <StackLayout Grid.Column="0" Spacing="2">
                            <Label Text="–°" FontSize="11" />
                            <Entry x:Name="QuietHoursStartEntry"
                                   Placeholder="22:00"
                                   Keyboard="Numeric"
                                   TextChanged="OnQuietHoursChanged" />
                        </StackLayout>
                        <StackLayout Grid.Column="1" Spacing="2">
                            <Label Text="–î–æ" FontSize="11" />
                            <Entry x:Name="QuietHoursEndEntry"
                                   Placeholder="08:00"
                                   Keyboard="Numeric"
                                   TextChanged="OnQuietHoursChanged" />
                        </StackLayout>
                    </Grid>

                    <!-- 4. –ü—Ä–æ—Ñ–∏–ª—å -->
                    <Label Text="–ü—Ä–æ—Ñ–∏–ª—å"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />

                    <Button Text="–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å"
                            Clicked="OnOpenProfileFromSettingsClicked"
                            BackgroundColor="#E0E0E0"
                            TextColor="#333333"
                            CornerRadius="8"
                            Padding="15,8"
                            HorizontalOptions="Fill" />

                    <Button Text="–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç"
                            Clicked="OnDeleteAccountClicked"
                            BackgroundColor="#FF5252"
                            TextColor="White"
                            CornerRadius="8"
                            Padding="15,8"
                            HorizontalOptions="Fill" />
                </StackLayout>
            </ScrollView>
            </Frame>
        </Grid>

        <!-- –ü–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ layout –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞) -->
        <Grid Grid.RowSpan="3" 
              ZIndex="1001"
              IsVisible="False"
              Opacity="0"
              x:Name="NotificationsOverlay">
            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnNotificationsOverlayTapped" />
            </Grid.GestureRecognizers>
            
            <!-- –ó–∞—Ç–µ–º–Ω–µ–Ω–Ω—ã–π —Ñ–æ–Ω -->
            <BoxView BackgroundColor="Black" 
                     Opacity="0.3"
                     InputTransparent="True" />
            
            <!-- –ü–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
            <Frame x:Name="NotificationsPanel"
                   BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}"
                   HasShadow="True"
                   CornerRadius="10"
                   Padding="15"
                   WidthRequest="350"
                   MaximumWidthRequest="400"
                   HeightRequest="500"
                   MaximumHeightRequest="600"
                   IsVisible="False"
                   Opacity="0"
                   Scale="1"
                   TranslationX="0"
                   InputTransparent="False"
                   HorizontalOptions="End"
                   VerticalOptions="Start"
                   Margin="10,60,10,0">
                <StackLayout Spacing="10">
                    <Label Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                           FontSize="18"
                           FontAttributes="Bold"
                           Margin="0,0,0,10" />

                    <ScrollView>
                        <StackLayout x:Name="NotificationsContainer" 
                                     Spacing="0" />
                    </ScrollView>
                </StackLayout>
            </Frame>
        </Grid>
    </Grid>
   
</ContentPage>
