<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Task_Scheduler.MainPage">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackLayout Grid.Row="0" 
                     Orientation="Vertical"
                     Padding="20">
            <Label x:Name="TasksLabel"
                   Text="–ó–∞–¥–∞—á–∏" 
                   FontSize="28"
                   HorizontalOptions="Center" 
                   Margin="0,10,0,10">
                <Label.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnTasksLabelClicked" />
                </Label.GestureRecognizers>
            </Label>

            <Label x:Name="NoTasksLabel"
                   Text="–ü–æ—Ö–æ–∂–µ, —É –≤–∞—Å –Ω–µ—Ç –∑–∞–¥–∞—á :(" 
                   FontSize="24" 
                   HorizontalOptions="Center" 
                   HorizontalTextAlignment="Center"
                   IsVisible="True"
                   Margin="10,10,0,10"/>

            <Button x:Name="CreateTaskButton"
                    Text="+ –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É" 
                    TextColor="#333333"
                    BackgroundColor="#F5F5F5"
                    CornerRadius="10"
                    Padding="20,10"
                    MinimumWidthRequest="150"
                    HorizontalOptions="Center"
                    Pressed="OnCreateTaskButtonPressed"
                    Released="OnCreateTaskButtonReleased"
                    Clicked="OnCreateTaskButtonClicked" />

            <ImageButton x:Name="PlusImageButton"
                        Source="plus.png"
                        WidthRequest="50"
                        HeightRequest="50"
                        HorizontalOptions="Center"
                        VerticalOptions="Center"
                        IsVisible="False"
                        Clicked="OnPlusImageButtonClicked" 
                        ToolTipProperties.Text="–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É"
                        Margin="0,0,0,0"/>
        </StackLayout>

        <Frame Grid.Row="1"
               BackgroundColor="White"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               WidthRequest="900"
               HeightRequest="900"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               Margin="20,0">
            <ScrollView Orientation="Vertical">
                <StackLayout x:Name="TasksContainer" 
                             Spacing="15"
                             VerticalOptions="Start" />
            </ScrollView>
        </Frame>

        <!-- "Task Scheduler" –≤ –ª–µ–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
        <Label Text="Task Scheduler" 
               FontSize="24" 
               HorizontalOptions="Start"
               VerticalOptions="Start"
               Margin="130,10,0,0" />

        <!-- –ê–≤–∞—Ç–∞—Ä –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É -->
        <ImageButton x:Name="AvatarImageButton"
                    Source="avatar.png"
                    WidthRequest="40"
                    HeightRequest="40"
                    CornerRadius="5"
                    HorizontalOptions="End"
                    VerticalOptions="Start"
                    Margin="0,0,10,0"
                    ToolTipProperties.Text="–ü—Ä–æ—Ñ–∏–ª—å"
                    Clicked="OnAvatarClicked" />
        
        <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <ImageButton x:Name="SettingsImageButton"
                     Source="setting.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,70,0"
                     ToolTipProperties.Text="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                     Clicked="OnSettingsClicked" />

        <ImageButton x:Name="NotificationsImageButton"
                     Source="notifications.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,130,0"
                     ToolTipProperties.Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                     Clicked="OnNotificationsClicked" />
        
        <ImageButton x:Name="FavoritesImageButton"
                     Source="favorites.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="End"
                     VerticalOptions="Start"
                     Margin="0,0,190,0"
                     ToolTipProperties.Text="–ò–∑–±—Ä–∞–Ω–Ω–æ–µ"
                     Clicked="OnFavoritesClicked" />

        <ImageButton x:Name="LogoImageButton"
                     Source="logo.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="80,0,0,0"                  
                     Clicked="OnAvatarClicked" />

        <ImageButton x:Name="MenuImageButton"
                     Source="menu.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,0,0,0"
                     ToolTipProperties.Text="–ú–µ–Ω—é"
                     Clicked="OnMenuClicked" />
        
        <ImageButton x:Name="RefreshImageButton"
                     Source="refresh.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,60,0,0"
                     ToolTipProperties.Text="–û–±–Ω–æ–≤–∏—Ç—å"
                     Clicked="OnRefreshClicked" />

        <ImageButton x:Name="SortImageButton"
                     Source="sort.png"
                     WidthRequest="40"
                     HeightRequest="40"
                     CornerRadius="5"
                     HorizontalOptions="Start"
                     VerticalOptions="Start"
                     Margin="20,120,0,0"
                     ToolTipProperties.Text="–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞"
                     Clicked="OnSortClicked" />

        <!-- –í—ã–¥–≤–∏–≥–∞—é—â–µ–µ—Å—è –º–µ–Ω—é -->
        <Grid x:Name="MenuOverlay"
              IsVisible="False"
              Opacity="0">
            <Grid.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnMenuOverlayTapped" />
            </Grid.GestureRecognizers>
        </Grid>

        <Frame x:Name="SideMenu"
               BackgroundColor="White"
               HasShadow="True"
               CornerRadius="0"
               Padding="20"
               WidthRequest="250"
               HorizontalOptions="Start"
               VerticalOptions="Start"
               TranslationX="-250"
               IsVisible="True">
            <StackLayout Spacing="15" VerticalOptions="Start">
                <Label Text="–ú–µ–Ω—é"
                       FontSize="20"
                       FontAttributes="Bold"
                       Margin="0,20,0,10" />

                <StackLayout x:Name="MenuMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnMenuMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="menu.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–ú–µ–Ω—é"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="RefreshMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnRefreshMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="refresh.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–û–±–Ω–æ–≤–∏—Ç—å"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>

                <StackLayout x:Name="SortMenuItem"
                             Orientation="Horizontal" 
                             Spacing="15" 
                             Margin="0,10,0,0"
                             BackgroundColor="Transparent"
                             Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnSortMenuItemTapped" />
                    </StackLayout.GestureRecognizers>
                    <Image Source="sort.png"
                           WidthRequest="30"
                           HeightRequest="30" />
                    <Label Text="–°–µ–≥–æ–¥–Ω—è"
                           FontSize="16"
                           VerticalOptions="Center" />
                </StackLayout>

                <Label Text="–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                       FontSize="16"
                       FontAttributes="Bold"
                       Margin="0,20,0,5" />
                <StackLayout x:Name="DisplayListMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,5,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayListTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìã –°–ø–∏—Å–æ–∫" FontSize="14" VerticalOptions="Center" />
                </StackLayout>
                <StackLayout x:Name="DisplayKanbanMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,5,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayKanbanTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìä Kanban" FontSize="14" VerticalOptions="Center" />
                </StackLayout>
                <StackLayout x:Name="DisplayCalendarMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,5,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayCalendarTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å" FontSize="14" VerticalOptions="Center" />
                </StackLayout>
                <StackLayout x:Name="DisplayGanttMenuItem" Orientation="Horizontal" Spacing="15" Margin="0,5,0,0" BackgroundColor="Transparent" Padding="5">
                    <StackLayout.GestureRecognizers>
                        <TapGestureRecognizer Tapped="OnDisplayGanttTapped" />
                    </StackLayout.GestureRecognizers>
                    <Label Text="üìà –ì–∞–Ω—Ç–∞" FontSize="14" VerticalOptions="Center" />
                </StackLayout>
            </StackLayout>
        </Frame>

        <!-- –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
        <Frame x:Name="SettingsPanel"
               BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}"
               HasShadow="True"
               CornerRadius="10"
               Padding="15"
               WidthRequest="280"
               HorizontalOptions="End"
               VerticalOptions="Start"
               Margin="0,60,10,0"
               IsVisible="False">
            <ScrollView MaximumHeightRequest="420">
                <StackLayout Spacing="16">
                    <Label Text="–ù–∞—Å—Ç—Ä–æ–π–∫–∏"
                           FontSize="18"
                           FontAttributes="Bold"
                           Margin="0,0,0,4" />

                    <!-- 1. –í–Ω–µ—à–Ω–∏–π –≤–∏–¥ -->
                    <Label Text="–í–Ω–µ—à–Ω–∏–π –≤–∏–¥"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <Picker x:Name="SettingsDisplayModePicker"
                            Title="–†–µ–∂–∏–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                            SelectedIndexChanged="OnSettingsDisplayModeChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–°–ø–∏—Å–æ–∫</x:String>
                                <x:String>Kanban</x:String>
                                <x:String>–ö–∞–ª–µ–Ω–¥–∞—Ä—å</x:String>
                                <x:String>–ì–∞–Ω—Ç–∞</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <!-- 2. –¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è -->
                    <Label Text="–¢–µ–º—ã –∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <Picker x:Name="SettingsThemePicker"
                            Title="–¢–µ–º–∞"
                            SelectedIndexChanged="OnSettingsThemeChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–°–∏—Å—Ç–µ–º–Ω–∞—è</x:String>
                                <x:String>–°–≤–µ—Ç–ª–∞—è</x:String>
                                <x:String>–¢—ë–º–Ω–∞—è</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>
                    <Picker x:Name="SettingsAccentPicker"
                            Title="–ê–∫—Ü–µ–Ω—Ç"
                            SelectedIndexChanged="OnSettingsAccentChanged">
                        <Picker.ItemsSource>
                            <x:Array Type="{x:Type x:String}">
                                <x:String>–§–∏–æ–ª–µ—Ç–æ–≤—ã–π</x:String>
                                <x:String>–°–∏–Ω–∏–π</x:String>
                                <x:String>–ó–µ–ª—ë–Ω—ã–π</x:String>
                                <x:String>–û—Ä–∞–Ω–∂–µ–≤—ã–π</x:String>
                            </x:Array>
                        </Picker.ItemsSource>
                    </Picker>

                    <!-- 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                    <Label Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                           FontSize="14"
                           FontAttributes="Bold"
                           TextColor="{AppThemeBinding Light=#333333, Dark=#E0E0E0}" />
                    <StackLayout Orientation="Horizontal" Spacing="10" VerticalOptions="Center">
                        <Label Text="–í–∫–ª—é—á–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                               VerticalOptions="Center"
                               FontSize="13" />
                        <Switch x:Name="SettingsNotificationsSwitch"
                                HorizontalOptions="EndAndExpand"
                                Toggled="OnSettingsNotificationsToggled" />
                    </StackLayout>
                    <Label Text="–¢–∏—Ö–∏–µ —á–∞—Å—ã (–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è):"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light=#666666, Dark=#B0B0B0}" />
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                        <StackLayout Grid.Column="0" Spacing="2">
                            <Label Text="–°" FontSize="11" />
                            <Entry x:Name="QuietHoursStartEntry"
                                   Placeholder="22:00"
                                   Keyboard="Numeric"
                                   TextChanged="OnQuietHoursChanged" />
                        </StackLayout>
                        <StackLayout Grid.Column="1" Spacing="2">
                            <Label Text="–î–æ" FontSize="11" />
                            <Entry x:Name="QuietHoursEndEntry"
                                   Placeholder="08:00"
                                   Keyboard="Numeric"
                                   TextChanged="OnQuietHoursChanged" />
                        </StackLayout>
                    </Grid>
                </StackLayout>
            </ScrollView>
        </Frame>

        <!-- –ü–∞–Ω–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ layout –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞) -->
        <AbsoluteLayout x:Name="NotificationsOverlay"
                        Grid.RowSpan="2" 
                        ZIndex="1000" 
                        InputTransparent="True"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill">
            <AbsoluteLayout.GestureRecognizers>
                <TapGestureRecognizer Tapped="OnNotificationsOverlayTapped" />
            </AbsoluteLayout.GestureRecognizers>
            <Frame x:Name="NotificationsPanel"
                   BackgroundColor="{AppThemeBinding Light={StaticResource White}, Dark={StaticResource OffBlack}}"
                   HasShadow="True"
                   CornerRadius="10"
                   Padding="15"
                   WidthRequest="350"
                   HeightRequest="500"
                   IsVisible="False"
                   Opacity="0"
                   InputTransparent="False"
                   AbsoluteLayout.LayoutBounds="0.95,60,350,500"
                   AbsoluteLayout.LayoutFlags="XProportional">
                <StackLayout Spacing="10">
                    <Label Text="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è"
                           FontSize="18"
                           FontAttributes="Bold"
                           Margin="0,0,0,10" />

                    <ScrollView>
                        <StackLayout x:Name="NotificationsContainer" 
                                     Spacing="0" />
                    </ScrollView>
                </StackLayout>
            </Frame>
        </AbsoluteLayout>
    </Grid>
   
</ContentPage>
